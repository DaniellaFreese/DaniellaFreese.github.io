<!doctype html><html itemscope itemtype=https://schema.org/WebPage class=no-js lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=siteBaseUrl content="https://DaniellaFreese.github.io"><meta name=author content="danny freese"><meta name=description content="danny freese coding blog as a female software engineer."><meta name=keywords content="danny freese,female software engineer blog,coding"><meta name=generator content="Hugo 0.110.0"><title>What Is Spiffe and How is it used in Kuma Mesh | Danny Freese - Coding for a Living</title><meta itemprop=name content="What Is Spiffe and How is it used in Kuma Mesh"><meta itemprop=description content="What Is Spiffe and How is it used in Kuma Mesh - danny freese coding blog as a female software engineer."><meta property="og:title" content="What Is Spiffe and How is it used in Kuma Mesh"><meta property="og:description" content="What Is Spiffe and How is it used in Kuma Mesh - danny freese coding blog as a female software engineer."><meta property="og:image" content="https://www.gravatar.com/avatar/d41d8cd98f00b204e9800998ecf8427e?size=200"><meta property="og:url" content="https://DaniellaFreese.github.io/article/mesh/kuma-mesh-what-is-spiffe/"><meta property="og:site_name" content="Danny Freese - Coding for a Living"><meta property="og:type" content="article"><script src=/modernizr-simple.js></script>
<link href=/article/mesh/kuma-mesh-what-is-spiffe/ rel=alternate type=application/rss+xml title="Danny Freese - Coding for a Living"><link href=/article/mesh/kuma-mesh-what-is-spiffe/ rel=feed type=application/rss+xml title="Danny Freese - Coding for a Living"><link rel=canonical href=https://DaniellaFreese.github.io/article/mesh/kuma-mesh-what-is-spiffe/><link rel=stylesheet href=https://DaniellaFreese.github.io/theme.css></head><body class=bilberry-hugo-theme><nav class="permanentTopNav sticky"><div class=container><ul class=topnav><li><a href=https://DaniellaFreese.github.io/page/projects/>Projects</a></li><li><a href=https://DaniellaFreese.github.io/page/about/>About</a></li><li><a href=https://github.com/DaniellaFreese target=_blank>Github</a></li></ul><div id=search-box class=search><i class="fas fa-search"></i>
<input id=search type=text placeholder="Search ..."></div></div></nav><header class=sticky><div class=container><div class=logo><a href=/ class=logo><img src=/images/square-modified.png alt>
<span class=overlay><i class="fa fa-home"></i></span></a></div><div class=titles><h3 class=title><a href=/>Danny Freese - Coding for a Living</a></h3><span class=subtitle>Hello World! I am constantly learning and happen to be a female software engineer. I thought it would be fun to document my thoughts, resources that help me, and journey.</span></div><div class="toggler permanentTopNav"><i class="fa fa-bars" aria-hidden=true></i></div></div></header><div class="main container"><div class="article-wrapper u-cf single"><a class=bubble href=https://DaniellaFreese.github.io/article/mesh/kuma-mesh-what-is-spiffe/><i class="fas fa-fw fa-pencil-alt"></i></a><article class="default article"><div class=content><h1 class=article-title><a href=https://DaniellaFreese.github.io/article/mesh/kuma-mesh-what-is-spiffe/>What Is Spiffe and How is it used in Kuma Mesh</a></h1><div class=meta><span class="date moment">2022-10-14</span>
<span class=categories><a href=https://DaniellaFreese.github.io/categories/service-mesh/>Service Mesh</a></span>
<span class=author><a href=https://DaniellaFreese.github.io/author/djfreese/>djfreese</a></span></div><p><strong>Situation:</strong> One of the first features everyone wants from a Service Mesh is to take advantage of the <code>Zero Trust / mTLS</code> that comes right out of the box. When you start to wondering into how this is all feasible in the world of workloads dynamically being created, destroyed, autoscaling the question becomes how does it all work?</p><p>In the <a href=https://kuma.io/docs/1.8.x/policies/mutual-tls/>Mutual TLS Doc of Kuma Mesh</a> it states the following:</p><p><code>The certificates that Kuma generates have a SAN set to spiffe://&lt;mesh name>/&lt;service name>. When Kuma enforces policies that require an identity like TrafficPermission it will extract the SAN from the client certificate and use it to match the service identity.</code></p><p>So! What is a <code>spiffe</code> and how is Kuma Mesh leveraging it?</p><h2 id=secure-production-identity-framework-for-everyone---spiffe>Secure Production Identity Framework for Everyone - Spiffe</h2><p>Spiffe stands for <code>Secure Production Identity Framework for Everyone</code>, and is a part of the CNCF.</p><p>A great resource to watch to get the fundamentals is the youtube video linked on the <a href=https://spiffe.io/>spiffe.io homepage</a>.</p><p><code>Spiffe</code> is basically a <code>specification</code> solving for security of cloud native workloads via <code>workload identity</code>. In translation:</p><p>In the world of dynamically shifting workloads that may be moving nodes, autoscaling, changing platforms, we need need to be able to secure communication between <code>Services</code> (i.e. <code>workloads</code>). In other words spiffe solves for the problem of <code>workload identity</code>.</p><h3 id=spiffe-specification-contains-three-main-concepts>Spiffe Specification contains three main concepts:</h3><p><strong>First</strong> - <code>spiffe id</code>: in the form of <code>spiffe://trust domain/workload identifier</code> which defines workload identity.</p><p><strong>Second</strong> - <code>SVID</code>: is used to prove the authenticatity of the spiffe id because the SVID is signed by a CA and can be in the format of an x509 certificate.</p><p><strong>Third</strong> - <code>Workload API</code> : to provision the svid and authority.</p><p>So how do these concepts apply to Kuma Mesh ?</p><h2 id=how-does-this-concept-map-to-kuma-mesh>How does this concept map to Kuma Mesh?</h2><p>Well the spiffe.io has a great summary of that:</p><p><code>Kuma automatically generates SPIFFE-compatible certificates that identify all the services and workloads running in the service mesh, and encrypts all the traffic generated between them</code>.</p><p>To validate this, we can enable mTLS on a a Kuma Mesh, grab the xDS configuration and trace it down. And that is what we will step through below.</p><h3 id=enable-mtls-on-the-mesh>Enable mTLS on the Mesh</h3><p>mTLS needs to be enabled on the mesh before starting. This can be done by taking advantage of the builtin-CA and just enabling it on the the default mesh:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 1</span><span><span style=color:#268bd2>type</span>: Mesh
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 2</span><span><span style=color:#268bd2>name</span>: default
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 3</span><span><span style=color:#268bd2>mtls</span>:
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 4</span><span>  <span style=color:#268bd2>enabledBackend</span>: ca-1
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 5</span><span>  <span style=color:#268bd2>backends</span>:
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 6</span><span>    - <span style=color:#268bd2>name</span>: ca-1
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 7</span><span>      <span style=color:#268bd2>type</span>: builtin
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 8</span><span>      <span style=color:#268bd2>dpCert</span>:
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 9</span><span>        <span style=color:#268bd2>rotation</span>:
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">10</span><span>          <span style=color:#268bd2>expiration</span>: 1d
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">11</span><span>      <span style=color:#268bd2>conf</span>:
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">12</span><span>        <span style=color:#268bd2>caCert</span>:
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">13</span><span>          <span style=color:#268bd2>RSAbits</span>: <span style=color:#2aa198>2048</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">14</span><span>          <span style=color:#268bd2>expiration</span>: 10y
</span></span></code></pre></div><p>With mTLS enabled we can start to read the xDS configuration of any dataplanes we have deployed in our mesh.</p><h2 id=navigating-the-xds-of-a-dataplane>Navigating the xDS of a Dataplane</h2><p><strong>So What did I find?</strong> Within the dynamic listener associated to the DP of a service, there is an additional TLS filter <code>DownstreamTlsContext</code> used by Envoy to filter any connections by valiating the SAN of the certification presented.</p><p><strong>1</strong> - Line 9 - defines what matching SAN it will accept, and in this case in line 11 we can see it&rsquo;s configured to expecte a <code>spiffe id</code>.</p><p><strong>2</strong> - Line 15 - defines the secret where the trusted CA secret is held.</p><p><strong>3</strong> - Line 23 - defines the secret where the <code>svid</code> can be found.</p><p><strong>4</strong> - Line 33 - we can also see from the configuration that a client cert is <code>required</code>.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 1</span><span>[Filter]&gt; .configs[2].dynamicListeners[0].activeState.listener.filterChains[0].transportSocket
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 2</span><span>{                                                                                                                                
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 3</span><span>  <span style=color:#268bd2>&#34;name&#34;: </span><span style=color:#2aa198>&#34;envoy.transport_sockets.tls&#34;</span>,                                                                                         
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 4</span><span>  <span style=color:#268bd2>&#34;typedConfig&#34;: </span>{                                                                                                               
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 5</span><span>    <span style=color:#268bd2>&#34;@type&#34;: </span><span style=color:#2aa198>&#34;type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.DownstreamTlsContext&#34;</span>,                               
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 6</span><span>    <span style=color:#268bd2>&#34;commonTlsContext&#34;: </span>{                                                                                                        
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 7</span><span>      <span style=color:#268bd2>&#34;combinedValidationContext&#34;: </span>{                                                                                             
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 8</span><span>        <span style=color:#268bd2>&#34;defaultValidationContext&#34;: </span>{                                                                                            
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 9</span><span>          <span style=color:#268bd2>&#34;matchSubjectAltNames&#34;: </span>[                                                                                              
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">10</span><span>            {                                                                                                                    
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">11</span><span>              <span style=color:#268bd2>&#34;prefix&#34;: </span><span style=color:#2aa198>&#34;spiffe://default/&#34;</span>                                                                                      
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">12</span><span>            }                                                                                                                    
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">13</span><span>          ]                                                                                                                      
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">14</span><span>        },                                                                                                                       
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">15</span><span>        <span style=color:#268bd2>&#34;validationContextSdsSecretConfig&#34;: </span>{                                                                                    
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">16</span><span>          <span style=color:#268bd2>&#34;name&#34;: </span><span style=color:#2aa198>&#34;mesh_ca:secret:default&#34;</span>,                                                                                      
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">17</span><span>          <span style=color:#268bd2>&#34;sdsConfig&#34;: </span>{                                                                                                         
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">18</span><span>            <span style=color:#268bd2>&#34;ads&#34;: </span>{},                                                                                                           
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">19</span><span>            <span style=color:#268bd2>&#34;resourceApiVersion&#34;: </span><span style=color:#2aa198>&#34;V3&#34;</span>                                                                                           
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">20</span><span>          }                                                                                                                      
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">21</span><span>        }                                                                                                                        
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">22</span><span>      },                                                                                                                         
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">23</span><span>      <span style=color:#268bd2>&#34;tlsCertificateSdsSecretConfigs&#34;: </span>[                                                                                        
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">24</span><span>        {                                                                                                                        
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">25</span><span>          <span style=color:#268bd2>&#34;name&#34;: </span><span style=color:#2aa198>&#34;identity_cert:secret:default&#34;</span>,                                                                                
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">26</span><span>          <span style=color:#268bd2>&#34;sdsConfig&#34;: </span>{                                                                                                         
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">27</span><span>            <span style=color:#268bd2>&#34;ads&#34;: </span>{},                                                                                                           
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">28</span><span>            <span style=color:#268bd2>&#34;resourceApiVersion&#34;: </span><span style=color:#2aa198>&#34;V3&#34;</span>                                                                                           
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">29</span><span>          }                                                                                                                      
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">30</span><span>        }                                                                                                                        
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">31</span><span>      ]                                                                                                                          
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">32</span><span>    },                                                                                                                           
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">33</span><span>    <span style=color:#268bd2>&#34;requireClientCertificate&#34;: </span><span style=color:#cb4b16>true</span>                                                                                             
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">34</span><span>  }                                                                                                                              
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">35</span><span>}
</span></span></code></pre></div><p><strong>So the <code>svid</code> and <code>trusted CA</code> are held in secrets. We can locate those as well.</strong></p><p>Under the dynamicActiveSecrets were the <code>identity_cert:secret:default</code> holding the tls cert and the <code>mesh_ca:secret:default</code> holding the trusted CA.</p><p>Locating the <code>identity_cert:secret:default</code> I used the jid filter:</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">1</span><span>.configs<span style=color:#719e07>[</span>5<span style=color:#719e07>]</span>.dynamicActiveSecrets<span style=color:#719e07>[</span>0<span style=color:#719e07>]</span>.secret.tlsCertificate.certificateChain.inlineBytes
</span></span></code></pre></div><p>The secret is base64 encoded so base64 decoded it:</p><p><code>echo LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0... | base64 -d > identity_cert.pem</code></p><p>and then using openssl to read the pem file: <code>openssl x509 -in identity_cert.pem -text -noout</code></p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-bash data-lang=bash><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 1</span><span>...
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 2</span><span>    Certificate:
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 3</span><span>        Data:
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 4</span><span>            Version: <span style=color:#2aa198>3</span> <span style=color:#719e07>(</span>0x2<span style=color:#719e07>)</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 5</span><span>            Serial Number:
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 6</span><span>                bf:93:6b:e1:fb:03:81:c8:3d:32:95:8a:ea:61:58:79
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 7</span><span>        Signature Algorithm: sha256WithRSAEncryption
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 8</span><span>            Issuer: <span style=color:#268bd2>O</span><span style=color:#719e07>=</span>Kuma, <span style=color:#268bd2>OU</span><span style=color:#719e07>=</span>Mesh, <span style=color:#268bd2>CN</span><span style=color:#719e07>=</span>default
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 9</span><span>            Validity
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">10</span><span>                Not Before: Oct <span style=color:#2aa198>18</span> 12:48:15 <span style=color:#2aa198>2022</span> GMT
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">11</span><span>                Not After : Oct <span style=color:#2aa198>19</span> 12:48:25 <span style=color:#2aa198>2022</span> GMT
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">12</span><span>        ...
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">13</span><span>            X509v3 extensions:
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">14</span><span>            ...
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">15</span><span>                X509v3 Subject Alternative Name: critical
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">16</span><span>                    URI:spiffe://default/monolith-service_svc_5000, URI:kuma://kuma.io/protocol/http, URI:kuma://kuma.io/service/monolith-service_svc_5000, URI:kuma://kuma.io/zone/on_prem
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">17</span><span>            ...
</span></span></code></pre></div><p>And we can see the spiffe id in the the Subject Alternative Name (SAN).</p><p>Then the second secret is the trusted CA, which is self explanatory.</p><div class=highlight><pre tabindex=0 style=color:#93a1a1;background-color:#002b36;-moz-tab-size:2;-o-tab-size:2;tab-size:2><code class=language-yaml data-lang=yaml><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 1</span><span>[Filter]&gt; .configs[5].dynamicActiveSecrets[1]    
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 2</span><span>{                                         
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 3</span><span>  <span style=color:#268bd2>&#34;lastUpdated&#34;: </span><span style=color:#2aa198>&#34;2022-10-18T12:48:25.899Z&#34;</span>,                      
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 4</span><span>  <span style=color:#268bd2>&#34;name&#34;: </span><span style=color:#2aa198>&#34;mesh_ca:secret:default&#34;</span>,                                   
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 5</span><span>  <span style=color:#268bd2>&#34;secret&#34;: </span>{                                                           
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 6</span><span>    <span style=color:#268bd2>&#34;@type&#34;: </span><span style=color:#2aa198>&#34;type.googleapis.com/envoy.extensions.transport_sockets.tls.v3.Secret&#34;</span>,
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 7</span><span>    <span style=color:#268bd2>&#34;name&#34;: </span><span style=color:#2aa198>&#34;mesh_ca:secret:default&#34;</span>,                                                 
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 8</span><span>    <span style=color:#268bd2>&#34;validationContext&#34;: </span>{                   
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050"> 9</span><span>      <span style=color:#268bd2>&#34;trustedCa&#34;: </span>{                                                                    
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">10</span><span>        <span style=color:#268bd2>&#34;inlineBytes&#34;: </span><span style=color:#2aa198>&#34;LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURPakNDQWlLZ0F3SUJBZ0lCQURBTkJna3Foa2lHOXcwQkFRc0ZBREF3TVEwd0N3WURWUVFLRXdSTGRXMWgKTVEwd0N3WURWUVFMRXdSTlpYTm9NUkF3RGdZRFZRUURFd2RrWldaaGRXeDBNQjRYRFRJeU1UQ
</span></span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">11</span><span><span style=color:#2aa198>      }                                                                                                                                                                                                                      
</span></span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">12</span><span><span style=color:#2aa198>    }                          
</span></span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">13</span><span><span style=color:#2aa198>  },                                                                                                                                                                                                                         
</span></span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">14</span><span><span style=color:#2aa198>  &#34;</span>versionInfo&#34;: &#34;0dc8f126-827c-449e-8af2-f36c8b704d24&#34;                                                                                                                                                                      
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#495050">15</span><span>}
</span></span></code></pre></div><h2 id=cool-all-done>Cool! All done</h2><p>That was a fun trace of what all is going on!</p><h2 id=references>References</h2><p>Just a list of all the references mentioned during the post.</p><ul><li><p><a href=https://kuma.io/docs/1.8.x/policies/mutual-tls/>Mutual TLS Doc of Kuma Mesh</a></p></li><li><p><a href=https://spiffe.io/>spiffe.io homepage</a></p></li><li><p><a href=https://spiffe.io/docs/latest/microservices/envoy-x509/readme/>Tutorial - Using Envoy with x509-SVIDs</a></p></li></ul></div><div class=footer><div class=tags><i class="fa fa-tags"></i><div class=links><a href=https://DaniellaFreese.github.io/tags/service-mesh/>service mesh</a>
<a href=https://DaniellaFreese.github.io/tags/kong-mesh/>Kong Mesh</a>
<a href=https://DaniellaFreese.github.io/tags/kuma/>Kuma</a>
<a href=https://DaniellaFreese.github.io/tags/envoy-proxy/>Envoy Proxy</a>
<a href=https://DaniellaFreese.github.io/tags/spiffe/>spiffe</a></div></div></div></article></div><div id=comments-container></div></div><footer><div class=container><div class=recent-posts><strong>Latest posts</strong><ul><li><a href=https://DaniellaFreese.github.io/code/ansible/copy-secret-between-namespaces/>How to Copy Secrets Between Namespaces with Kubernetes Core Ansible Collection</a></li><li><a href=https://DaniellaFreese.github.io/code/ansible/kube-services/>Ansible - How to Wait for on a Kubernetes Service with the Kubernetes Core Collection</a></li><li><a href=https://DaniellaFreese.github.io/article/books/year-2022/>Book List of 2022 - A recap of the books read</a></li><li><a href=https://DaniellaFreese.github.io/article/openshift/fav-ocp-security-posts/>Openshift Security Best References</a></li><li><a href=https://DaniellaFreese.github.io/code/ansible/module-unit-tests-mac/>How to Write an Ansible Module Unit Test in the Ansible Collection Paradigm</a></li><li><a href=https://DaniellaFreese.github.io/article/mesh/kuma-mesh-what-is-spiffe/>What Is Spiffe and How is it used in Kuma Mesh</a></li><li><a href=https://DaniellaFreese.github.io/article/mesh/kuma-envoy-proxy-filterchains/>Kong Mesh - Understanding how Kong Mesh translates TrafficRoute Policies to Envoy Proxy Configuration</a></li></ul></div><div class=categories><a href=/categories/><strong>Categories</strong></a><ul><li><a href=/categories/ansible>Ansible
(4)</a></li><li><a href=/categories/service-mesh>Service mesh
(4)</a></li><li><a href=/categories/books>Books
(1)</a></li><li><a href=/categories/openshift>Openshift
(1)</a></li><li><a href=/categories/women-in-tech>Women in tech
(1)</a></li></ul></div><div class=right><div class=external-profiles><strong>Social media</strong>
<a href=https://github.com/DaniellaFreese target=_blank><i class="fab fa-github"></i></a>
<a href=https://www.linkedin.com/in/daniellafreese/ target=_blank><i class="fab fa-linkedin"></i></a></div></div></div></footer><div class=credits><div class=container><div class=copyright><a href=https://github.com/Lednerb target=_blank>&copy;
2023
by Lednerb</a></div><div class=author><a href=https://github.com/Lednerb/bilberry-hugo-theme target=_blank>Bilberry Hugo Theme</a></div></div></div><script async src="https://www.googletagmanager.com/gtag/js?id=G-JRGW0G2KDK"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-JRGW0G2KDK",{anonymize_ip:!1})}</script><script src=https://DaniellaFreese.github.io/theme.js></script><div id=activate-algolia-search class=hidden><input type=hidden id=algolia-search-appId value=45CEN6X6AT>
<input type=hidden id=algolia-search-apiKey value=16030625f1a4d0dd3b8aefd794fd4cf1>
<input type=hidden id=algolia-search-indexName value=bilberry-hugo-theme>
<input type=hidden id=algolia-search-noSearchResults value="Nothing found.">
<input type=hidden id=algolia-search-currentLanguageOnly></div></body></html>